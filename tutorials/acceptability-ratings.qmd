---
title: "Acceptability Ratings"
author: "Francesca Capuano"
date: today
bibliography: ../references.bib
csl: apa.csl
---

See @bross2019acceptability for a more thorough tutorial on how to analyse acceptability ratings. Below is an example of how a final analysis script might look like.

## Data

We simulate a dataset with **subjects** and **items** as random factors.  
We manipulate **word order** (SVO vs SOV), within-subject and within-item.

```{r}
library(tibble)

# Simulate dataset: 10 subjects × 6 items
set.seed(123)
df <- tibble(
  subject = rep(1:10, each = 6),
  item = rep(1:3, each = 2, times=10),
  word_order = rep(c("SVO", "SOV"), times=3*10),
  sentence = rep(c(
    "The cat chased the mouse.",     # SVO
    "The cat the mouse chased.",     # SOV
    "She reads books every night.",  # SVO
    "She every night books reads.",  # SOV
    "They are visiting the park.",   # SVO
    "They the park are visiting."    # SOV
  ), times=10),
  rating = sample(1:5, 60, replace = TRUE)
)

# Convert to factors for modeling
df$word_order <- factor(df$word_order)
df$subject <- factor(df$subject)
df$item <- factor(df$item)

# Quick check
head(df)
```

#### Descriptive plot

This plot shows rating distributions and means by word order.
```{r, message=FALSE}
library(ggplot2)
library(dplyr)

# calculate percentage of ratings per word_order
plot_data <- df %>%
  group_by(word_order, rating) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(word_order) %>%
  mutate(percent = n / sum(n) * 100)

# calculate mean ratings per word_order
mean_data <- df %>%
  group_by(word_order) %>%
  summarise(mean_rating = mean(as.numeric(as.character(rating))), .groups = "drop")

# colors for 5-point scale
colors <- c("#b2df8a", "#a6d854", "#ffffb3", "#fdb462", "#fb8072")

# transform rating to ordinal for the plot
plot_data$rating <- factor(plot_data$rating, levels = 1:5)

# Plot
ggplot(plot_data, aes(x = rating, y = percent, fill = rating)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = sprintf("%.1f%%", percent)), vjust = -0.5, size = 3) +
  facet_wrap(~word_order, ncol = 1) +
  geom_vline(
    data = mean_data,
    aes(xintercept = mean_rating),
    linetype = "dashed",
    color = "black",
    linewidth = 0.5
    ) +
  geom_text(
    data = mean_data,
    aes(x = mean_rating, y = 105, label = sprintf("%.2f", mean_rating)),
    inherit.aes = FALSE,
    vjust = 1,
    hjust = -0.1,
    size = 3
    ) +
  scale_fill_manual(values = colors) +
  scale_y_continuous(limits = c(0, 115), expand = c(0, 0)) +
  labs(
    x = "Rating",
    y = "Percentage",
    fill = "Rating Scale"
    ) +
  theme_minimal(base_size = 14) +
  theme(legend.position = "bottom")
```
Plot by Jennifer Huege.


## Analysis

Although ratings are ordinal, they are often treated as interval data for scales ≥ 5 points.

Because interval data can be analyzed with linear models, and because psycholinguistic designs usually include **both subjects and items as random factors**, it is common practice to use **linear mixed effect models (LMMs)** to account for this crossed structure.

For an introduction to mixed models, see @winter2019statistics. 

For a debate on the specification of the random effects structure of the model, see @barr2013random and @matuschek2017balancing.

### Linear Mixed Model (LMM)
```{r, message=FALSE}
library(lmerTest)

# Linear Mixed Model (LMM)
m <- lmer(rating ~ word_order 
          + (1|subject) # adds a random intercept for each participant
          + (1|item), # adds a random intercept for each item
          data = df)
summary(m)
```
**Interpretation**:

The fixed effect of word_order tests whether SVO and SOV sentences differ in mean ratings.

- (1|subject) captures participant variability.

- (1|item) captures sentence variability.

#### Example Report

"The model revealed no significant effect of word order. Specifically, SVO sentences were slightly lower than SOV sentences, but the difference was not statistically significant (*β* = -0.23, *SE* = 0.34, *t*(56) = -0.68, *p* = .50)."

#### Plot of the means predicted by the model.

```{r, message=FALSE}
library(emmeans)

# plot predicted mean acceptability rating
emm <- emmeans(m, ~ word_order)
df$rating <- factor(df$rating, ordered = TRUE, levels = 1:5)
plot(emm)
```

### Cumulative Link Mixed Model (CLMM)
A more conservative analysis treating ratings as ordinal.
```{r, message=FALSE}
library(ordinal)

# Cumulative Link Mixed Model (CLMM) --> more conservative
df$rating <- factor(df$rating, ordered = TRUE, levels = 1:5)
m2 <- clmm(rating ~ word_order + (1|subject) + (1|item), data = df)
summary(m2)
```